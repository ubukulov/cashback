(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{642:function(t,e,s){"use strict";s.r(e);var a=s(873),r=s(716);for(var n in r)"default"!==n&&function(t){s.d(e,t,function(){return r[t]})}(n);var l=s(1),i=Object(l.a)(r.default,a.a,a.b,!1,null,null,null);i.options.__file="index.vue",e.default=i.exports},716:function(t,e,s){"use strict";s.r(e);var a=s(717),r=s.n(a);for(var n in a)"default"!==n&&function(t){s.d(e,t,function(){return a[t]})}(n);e.default=r.a},717:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a,r=s(17),n=(a=r)&&a.__esModule?a:{default:a};e.default={name:"user-loyalty",data:function(){return{open:!1,currentCustom:{status:"",currentPercent:"",message:""},letyStatuses:{start:{percent:0,amount:0,currency:"",name:""},bronze:{percent:0,amount:0,currency:"",name:""},silver:{percent:0,amount:0,currency:"",name:""},gold:{percent:0,amount:0,currency:"",name:""}},premiumPrice:150,premiumCurrency:"RUB",descriptionHelper:{LetyStart:500,LetyBronze:3e3,LetySilver:3e3,LetyGold:1e4}}},props:{loyaltyDescriptions:{type:Object},loyalty:{type:Object,required:!0},premium:{type:Object,required:!1},premiumPercent:{type:Number},withdrawUrl:String},components:{UserLoyaltyBar:s(841).default},computed:{overall:function(){return this.loyalty&&this.loyalty.amount&&(this.loyalty.amount.overall||0)},pending:function(){return this.$user.balancePending},beforeBronze:function(){return this.letyStatuses.bronze.amount-this.overall},isPremium:function(){return!!this.loyalty.has_premium}},mounted:function(){var t=this;this.letyStatuses.start=this.loyalty.level.list[0],this.letyStatuses.bronze=this.loyalty.level.list[1],this.letyStatuses.silver=this.loyalty.level.list[2],this.letyStatuses.gold=this.loyalty.level.list[3],this.descriptionHelper.LetyStart=this.letyStatuses.bronze.amount,this.descriptionHelper.LetyBronze=this.letyStatuses.silver.amount,this.descriptionHelper.LetySilver=this.letyStatuses.silver.amount,this.descriptionHelper.LetyGold=this.letyStatuses.gold.amount;var e=this.loyalty.premiums.list.find(function(e){return t.loyalty.premiums.defaults.purchase===e.code}),s=this.loyalty.premiums.list.find(function(e){return t.loyalty.premiums.defaults.after_registration===e.code});if(this.premiumPrice=e.price,this.premiumCurrency=e.currency,this.loyalty.has_premium){var a=void 0;return this.currentCustom.message=e.name,this.premium.code===e.code?a=e:(a=s,this.currentCustom.message="Premium_start"),this.currentCustom.status=a.name,void(this.currentCustom.currentPercent="(+"+this.premium.bonus+"%)")}return this.loyalty.level.current.name?(this.currentCustom.status=this.loyalty.level.current.name,this.currentCustom.message=this.loyalty.level.current.name,void this.loyalty.level.list.map(function(e){e.name===t.loyalty.level.current.name&&e.percent>0&&(t.currentCustom.currentPercent="(+"+e.percent+"%)")})):n.default.get("status")?"1"===n.default.get("status").split("@")[0]?this.open=!0:"0"===n.default.get("status").split("@")[0]?this.open=!1:void 0:(n.default.set("status","1@"+this.currentCustom.message,{expires:365,path:"/",domain:this.$cookieDomain}),this.open=!0)},methods:{renameStatus:function(t){return t.replace(/^Lety/,"Lety-")},levelNextTranslation:function(t){var e=this.renameStatus(t);return this.$t("cabinet.userLoyalty.loyaltyLevelNext",{name:e})},getStatusDesc:function(){var t=this.loyaltyDescriptions[this.currentCustom.message],e=this.descriptionHelper[this.currentCustom.message];return void 0!==e&&(t=t.replace("$currency",this.$options.filters.humanMoney(this.premiumCurrency)).replace("$amount",e)),t},toggle:function(){this.open=!this.open},hide:function(){n.default.set("status","0@"+this.currentCustom.message,{expires:365,path:"/",domain:this.$cookieDomain}),this.open=!1},checkTime:function(t){return t<10&&(t="0"+t),t},getCodeDate:function(t){var e=new Date(t);return this.checkTime(e.getDate())+"."+this.checkTime(e.getMonth()+1)+"."+this.checkTime(e.getFullYear())}}}},718:function(t,e,s){"use strict";s.r(e);var a=s(719),r=s.n(a);for(var n in a)"default"!==n&&function(t){s.d(e,t,function(){return a[t]})}(n);e.default=r.a},719:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={data:function(){return{point:{type:"",labelText:""},cookieStatus:{name:""},calcTotal:"",calcAmount:""}},props:{data:Object,total:Number,premiumPercent:Number,hasPremium:Boolean,pending:Number,letyStatuses:Object,premiumCurrency:String,premiumPrice:Number},methods:{transformStatusName:function(t){return t.toLowerCase().replace("lety","")},activeItem:function(t){return this.total>=t},calcStatusBallance:function(t,e){return t>1?{calcAmount:e-this.data.list[t-1].amount,calcTotal:this.total-this.data.list[t-1].amount}:{calcAmount:e,calcTotal:this.total}},getMessage:function(t){return"+ "+this.letyStatuses[this.transformStatusName(t.name)].percent+this.$t("cabinet.userLoyalty.plusPercent")},chunkSpanWidth:function(t,e){var s=this.calcStatusBallance(t,e),a=Math.floor(s.calcTotal/s.calcAmount*100);return a<=100?a+"%":"100%"},pendingChunkSpanWidth:function(t,e){var s=this.calcStatusBallance(t,e),a=Math.floor((s.calcTotal+this.pending)/e*100);return a<=100?a+"%":"100%"},getPremiumForm:function(){this.$modal.show("premium-form")},renameStatus:function(t){return t.replace(/^Lety/,"Lety-")}},components:{PremiumForm:s(842).default},computed:{activeCount:function(){var t=this,e=0;return this.data.list.map(function(s){t.total>=s.amount&&s.amount>0&&e++}),e},chunkWidth:function(){return 100/(this.data.list.length-1)+"%"},premiumCurrencyHumanMoney:function(){return this.$options.filters.humanMoney(this.premiumCurrency)},premiumPayload:function(){return{premiumPercent:this.premiumPercent,premiumPrice:this.premiumPrice,premiumCurrencyHumanMoney:this.premiumCurrencyHumanMoney}}}}},720:function(t,e,s){"use strict";s.r(e);var a=s(721),r=s.n(a);for(var n in a)"default"!==n&&function(t){s.d(e,t,function(){return a[t]})}(n);e.default=r.a},721:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n(s(163)),r=n(s(12));function n(t){return t&&t.__esModule?t:{default:t}}e.default={props:{overlay:{type:Number,default:0},amount:{type:Number,default:150},currency:{type:String,default:"RUB"}},data:function(){return{process:!1}},methods:{opened:function(){var t=this;this.process||(this.process=!0,a.default.getPremiumFormBuying().then(function(e){var s=r.default.compile(e.data);new r.default({data:{currency:t.currency,amount:t.amount},render:s.render,staticRenderFns:s.staticRenderFns}).$mount(t.$el.querySelector("[data-module-root]")),t.process=!1,t.$nextTick(function(){var t=document.getElementById("bpr");t&&t.addEventListener("submit",function(t){document.getElementById("formButton").setAttribute("disabled",!0)})}),t.$analytics.premiumPreview(Math.round(t.overlay).toString())}).catch(function(){t.process=!1,t.close()}))},close:function(){this.$modal.hide("premium-form")}}}},841:function(t,e,s){"use strict";s.r(e);var a=s(910),r=s(718);for(var n in r)"default"!==n&&function(t){s.d(e,t,function(){return r[t]})}(n);var l=s(1),i=Object(l.a)(r.default,a.a,a.b,!1,null,null,null);i.options.__file="UserLoyaltyBar.vue",e.default=i.exports},842:function(t,e,s){"use strict";s.r(e);var a=s(932),r=s(720);for(var n in r)"default"!==n&&function(t){s.d(e,t,function(){return r[t]})}(n);var l=s(1),i=Object(l.a)(r.default,a.a,a.b,!1,null,null,null);i.options.__file="PremiumForm.vue",e.default=i.exports},873:function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"b-user-loyalty border-solid"},[s("div",[s("div",{staticClass:"b-user-loyalty__flex-wrapper"},[t.loyalty?s("div",{staticClass:"b-user-loyalty__content"},[s("div",{staticClass:"b-loyalty-top",class:{"b-loyalty-top--open-message":t.open}},[s("div",{staticClass:"b-loyalty-top__user-status"},[s("div",{staticClass:"b-loyalty-top__top-left"},[s("div",{staticClass:"b-loyalty-top__brief-info"},[s("div",[s("div",{staticClass:"b-user-loyalty__label"},[t._v("\n                                        "+t._s(t.$t("cabinet.userLoyalty.status"))+"\n                                    ")]),t._v(" "),s("div",[s("span",{staticClass:"b-loyalty-top__label-status"},[t._v("\n                                            "+t._s(t.renameStatus(t.currentCustom.status)+" "+t.currentCustom.currentPercent)+"\n                                        ")]),t._v(" "),s("div",{staticClass:"b-loyalty-top__small-label"},[t.isPremium?s("span",[t._v("\n                                                "+t._s(t.$t("cabinet.userLoyalty.premiumUntil"))+" "+t._s(t.getCodeDate(t.premium.active_until))+"\n                                            ")]):t._e()])])]),t._v(" "),s("div",{staticClass:"b-loyalty-top__btn-more",class:{"b-loyalty-top__btn-more--active":t.open},on:{click:t.toggle}},[s("span",{staticClass:"b-loyalty-top__text-dashed"},[t._v("\n                                        "+t._s(t.$t("cabinet.userLoyalty.moreInfo"))+"\n                                    ")]),t._v(" "),s("svgIcon",{attrs:{name:"ls-black-arrow"}})],1)])]),t._v(" "),s("div",{staticClass:"b-loyalty-top__top-right"},[s("div",[t.loyalty.level.current?s("div",[t.loyalty.level.next?s("div",{staticClass:"b-loyalty-top__flex-between"},[s("span",{staticClass:"b-user-loyalty__label"},[t._v("\n                                            "+t._s(t.levelNextTranslation(t.loyalty.level.next.name))+"\n                                        ")]),t._v(" "),s("span",{staticClass:"b-user-loyalty__bold"},[t._v("\n                                            "+t._s(t._f("numberFormat")(t.loyalty.level.next.delta))+" "+t._s(t._f("humanMoney")(t.loyalty.amount.currency))+"\n                                        ")])]):s("div",{staticClass:"b-loyalty-top__flex-between"},[s("span",{staticClass:"b-user-loyalty__label"},[t._v(t._s(t.$t("cabinet.userLoyalty.maxLevel")))])])]):t._e()]),t._v(" "),s("div",{staticClass:"b-loyalty-top__flex-between"},[s("span",{staticClass:"b-user-loyalty__label"},[t._v(t._s(t.$t("cabinet.userLoyalty.accumulatedAll")))]),t._v(" "),s("span",{staticClass:"b-user-loyalty__bold"},[t._v("\n                                    "+t._s(t._f("numberFormat")(t.overall))+" "+t._s(t._f("humanMoney")(t.loyalty.amount.currency))+"\n                                ")])])])]),t._v(" "),t.open?s("div",{staticClass:"b-loyalty-message-bar"},[s("div",{staticClass:"b-loyalty-message-bar__message"},[s("div",{staticClass:"b-loyalty-message-bar__btn-close",on:{click:t.hide}},[s("svgIcon",{attrs:{name:"ls-close"}})],1),t._v(" "),s("div",{staticClass:"b-loyalty-message-bar__description"},[s("div",{domProps:{innerHTML:t._s(t.getStatusDesc())}}),t._v(" "),s("div",{domProps:{innerHTML:t._s(t.loyaltyDescriptions.description)}})])])]):t._e()]),t._v(" "),s("user-loyalty-bar",{attrs:{hasPremium:t.loyalty.has_premium,"premium-percent":t.premiumPercent,total:t.overall,pending:t.pending,premiumPrice:t.premiumPrice,premiumCurrency:t.premiumCurrency,letyStatuses:t.letyStatuses,data:t.loyalty.level}})],1):t._e()])])])},r=[];s.d(e,"a",function(){return a}),s.d(e,"b",function(){return r})},910:function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"b-user-loyalty__bottom"},[s("div",{staticClass:"b-user-loyalty__flex-inner"},[s("div",{staticClass:"b-user-loyalty__status-bar"},[s("div",{staticClass:"b-user-loyalty__status-flex"},[s("div",{staticClass:"b-user-loyalty__status-bar-item"},[s("div",{staticClass:"b-tooltip b-tooltip--top-58 b-user-loyalty__status b-user-loyalty__status--LetyStart"},[s("span",[t._v("Start")]),t._v(" "),s("span",{staticClass:"b-tooltip__body b-tooltip__body--small-180 b-tooltip__body--center"},[t._v("\n                            "+t._s(t.$t("cabinet.userLoyalty.baseRate"))+"\n                        ")])]),t._v(" "),s("div",{staticClass:"b-user-loyalty__status-name"},[t._v("Lety-Start")])]),t._v(" "),t._l(t.data.list,function(e,a){return e.amount>0?s("div",{key:a,staticClass:"b-user-loyalty__status-bar-item",class:{"b-user-loyalty__status-bar-item--active":t.activeItem(e.amount)}},[s("div",{class:"b-tooltip b-tooltip--top-58 b-user-loyalty__status b-user-loyalty__status--"+e.name},[s("span",[t._v("+"+t._s(e.percent)+"%")]),t._v(" "),s("span",{staticClass:"b-tooltip__body b-tooltip__body--small-220 b-tooltip__body--center"},[t._v("\n                            "+t._s(t.getMessage(e))+"\n                        ")])]),t._v(" "),s("div",{staticClass:"b-user-loyalty__status-name"},[t._v(t._s(t.renameStatus(e.name)))]),t._v(" "),s("div",{staticClass:"b-user-loyalty__status-value"},[t._v("\n                        "+t._s(e.amount)+"\n                        "+t._s(t._f("humanMoney")(t.$user.balanceCurrency))+"\n                    ")])]):t._e()})],2),t._v(" "),s("div",{staticClass:"b-user-loyalty__progress-bar"},[s("div",{staticClass:"b-user-loyalty__progress"},t._l(t.data.list,function(e,a){return e.amount>0?s("div",{key:a,staticClass:"b-user-loyalty__chunk",class:{"b-user-loyalty__chunk--active":t.activeItem(e.amount)},style:{width:t.chunkWidth}},[t.activeCount>=a-1?s("span",{staticClass:"status-amount",style:{width:t.chunkSpanWidth(a,e.amount)}}):t._e(),t._v(" "),t.activeCount>=a?s("span",{staticClass:"status-pending",style:{width:t.pendingChunkSpanWidth(a,e.amount)}}):t._e()]):t._e()}))])]),t._v(" "),this.data.next?s("div",{staticClass:"b-user-loyalty__premium"},[s("div",{staticClass:"b-user-loyalty__status-bar-item b-user-loyalty__status-bar-item--LetyPremium"},[s("div",{staticClass:"b-tooltip b-tooltip--top-58 b-user-loyalty__status b-user-loyalty__status--Premium"},[s("span",[t._v("+"+t._s(t.premiumPercent)+"%")]),t._v(" "),s("span",{staticClass:"b-tooltip__body"},[t._v("\n                        "+t._s(t.$t("cabinet.userLoyalty.premiumTooltip",t.premiumPayload))+"\n                    ")])]),t._v(" "),s("div",{staticClass:"b-user-loyalty__status-name b-user-loyalty__status-name--large"},[t._v("Premium")]),t._v(" "),t.hasPremium?t._e():s("div",{staticClass:"b-user-loyalty__premium-status b-user-loyalty__premium-action",on:{click:function(e){return e.preventDefault(),t.getPremiumForm(e)}}},[s("span",[t._v("\n                        "+t._s(t.$t("cabinet.userLoyalty.connectPremium",t.premiumPayload))+"\n                    ")])]),t._v(" "),t.hasPremium?s("div",{staticClass:"b-user-loyalty__label"},[t._v(t._s(t.$t("cabinet.userLoyalty.premiumConnected")))]):t._e()])]):t._e()]),t._v(" "),s("premium-form",{attrs:{overlay:t.total,amount:t.premiumPrice,currency:t.premiumCurrency}})],1)},r=[];s.d(e,"a",function(){return a}),s.d(e,"b",function(){return r})},932:function(t,e,s){"use strict";var a=function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("modal",{staticClass:"premium-form-popup",attrs:{transition:"nice-modal-fade",scrollable:!0,adaptive:!0,name:"premium-form"},on:{opened:this.opened}},[e("svgIcon",{staticClass:"v--modal__close",attrs:{slot:"top-right",name:"ls-close"},slot:"top-right"}),this._v(" "),this.process?e("div",{staticClass:"b-spinner b-spinner--overlay"},[e("svgSpinner")],1):this._e(),this._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:!this.process,expression:"!process"}]},[e("div",{attrs:{"data-module-root":""}})])],1)],1)},r=[];s.d(e,"a",function(){return a}),s.d(e,"b",function(){return r})}}]);